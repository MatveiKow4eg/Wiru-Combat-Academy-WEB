<!doctype html>
<html lang="{{ session.get('lang', 'ru') }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Wiru Combat Academy {% endblock %}</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Anton&family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">


  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <script defer src="{{ url_for('static', filename='js/main.js') }}"></script>
  {% block extra_css %}{% endblock %}
  <style>
    /* Mobile-only override: slightly narrower side drawer */
    @media (max-width: 640px) {
      #nav.nav { width: 72vw; max-width: 280px; }
      /* show right-side buttons also on mobile */
      .header-actions .btn { display: inline-block !important; }
    }
    /* improve spacing in right header area */
    .header-actions { gap: 16px; }
    .auth-ctrls { display:flex; align-items:center; gap: 14px; }
    .lang-switch { margin-right: 6px; }
    /* header auth controls */
    .header-actions .header-link {
      color: #ddd; text-transform: uppercase; font-size: 14px; font-weight: 600;
    }
    .header-actions .header-link:hover { color: var(--accent); }
    .header-actions .user-avatar {
      width: 36px; height: 36px;
      display: inline-flex; align-items: center; justify-content: center;
      color: #ddd; background: #1a1a1a; border: 1px solid #333; border-radius: 50%;
      transition: border-color .2s ease, color .2s ease, background .2s ease;
      vertical-align: middle;
    }
    .header-actions .user-avatar:hover { border-color: var(--accent); color: #fff; background: #222; }
    @media (min-width: 641px){
      .header-actions{ justify-self: end; }
      .header .nav{ justify-self: center; }
    }
  </style>
</head>
<body>
<header class="header">
  <div class="container header-inner">
    <!-- Лого -->
    <div class="logo">
      <a href="{{ url_for('home') }}">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Wiru Combat Academy Logo">
      </a>
    </div>

    <nav id="nav" class="nav">
      <div class="nav-header">
        <a class="nav-logo" href="{{ url_for('home') }}">
          <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Wiru Combat Academy Logo">
        </a>
      </div>
      <a href="{{ url_for('home') }}">{{ _('Главная') }}</a>
      <a href="{{ url_for('news_list') }}">{{ _('Новости') }}</a>
      <a href="{{ url_for('schedule_page') }}">{{ _('Расписание') }}</a>
      <a href="{{ url_for('trainers_page') }}">{{ _('Тренеры') }}</a>
      <a href="{{ url_for('contact') }}">{{ _('Контакты') }}</a>
            <a href="{{ url_for('signup') }}" class="btn btn-accent nav-cta" style="margin-top:auto; display:block; text-align:center;">{{ _('Записаться') }}</a>
    </nav>
        <div class="header-actions">
      <div class="lang-switch">
        {% for code in LANGUAGES %}
          <a class="lang {{ 'active' if session.get('lang','ru')==code else '' }}" href="{{ request.path }}?lang={{ code }}">{{ code.upper() }}</a>
        {% endfor %}
      </div>
      <div class="auth-ctrls">
        {% if not current_user.is_authenticated %}
          <a class="btn" href="{{ url_for('login') }}">{{ _('Войти') }}</a>
        {% else %}
          {% if current_user.role == 'admin' %}
            <a class="header-link" href="{{ url_for('admin_dashboard') }}">{{ _('Админ-панель') }}</a>
          {% endif %}
          <a href="{{ url_for('profile') }}" class="user-avatar" title="{{ _('Профиль') }}" aria-label="{{ _('Профиль') }}">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M20 21a8 8 0 0 0-16 0"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </a>
          <a class="header-link" href="{{ url_for('logout') }}">{{ _('Выход') }}</a>
        {% endif %}
      </div>
      <button class="burger" aria-label="Menu" onclick="toggleMenu()">☰</button>
    </div>
  </div>
</header>
<div id="navOverlay" class="nav-overlay" onclick="toggleMenu()"></div>

<main class="main">
  {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
    <div class="flash" id="flash">
      {% for cat, m in messages %}
        <div class="flash-item {{ cat|default('message') }}">{{ m }}</div>
      {% endfor %}
    </div>
    <script>
      // Auto-hide flash messages after 1 second with a smooth transition
      (function(){
        var container = document.getElementById('flash');
        if (!container) return;
        setTimeout(function(){
          var items = container.querySelectorAll('.flash-item');
          items.forEach(function(el){ el.classList.add('hide'); });
          setTimeout(function(){
            if (container && container.parentNode) container.parentNode.removeChild(container);
          }, 300);
        }, 1000);
      })();
    </script>
    {% endif %}
  {% endwith %}
  {% block content %}{% endblock %}
</main>
<footer class="footer">
  <div class="footer-container">
    <!-- Форма + Логотип -->
    <div class="footer-top">
      <div class="footer-form">
        <h3>{{ _('Напишите нам') }}</h3>
        <form method="POST" action="/send-message">
          <div class="form-row two-cols">
            <input type="text" name="name" placeholder="{{ _('Ваше имя') }}" required>
            <input type="email" name="email" placeholder="{{ _('Ваш Email') }}" required>
          </div>
          <textarea name="message" placeholder="{{ _('Ваше сообщение') }}" rows="5" required></textarea>
          <button type="submit">{{ _('Отправить') }}</button>
        </form>
      </div>

      <!-- Логотип справа -->
      <div class="footer-logo">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Wiru Combat Academy Logo">
      </div>
    </div>

    <!-- Карта + контакты -->
    <div class="footer-bottom">
      <div class="footer-map">
        <div style="width:100%; height:400px;">
  <iframe
    src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d1925.701057225439!2d27.275484534636032!3d59.397257499382036!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x469471e0e775ef25%3A0xb0da126ff4f8ee0f!2sWiru%20Spordikeskus!5e0!3m2!1sru!2sus!4v1758046051065!5m2!1sru!2sus"
    width="100%"
    height="100%"
    style="border:0; border-radius:8px;"
    allowfullscreen=""
    loading="lazy"
    referrerpolicy="no-referrer-when-downgrade">
  </iframe>
</div>

      </div>

      <div class="footer-contacts">
        <h3>{{ _('Контакты') }}</h3>
        <p>Järveküla tee 41, Järve, 30321 <br>Ida-Viru maakond</p>
        <p>+372 5555 5555</p>
        <p>info@wiruacademy.ee</p>
        <h3>{{ _('Банк') }}</h3>
        <p>YOUR NAME OU </p>
        <p>EE xxxxxxxxxxxxxxxxxxxxx</p>
        <p>EE xxxxxxxxxxxxxxxxxxxxx</p>
        <div class="socials">
          <a href="#">Instagram</a> • 
          <a href="#">Facebook</a> • 
          <a href="#">YouTube</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Нижняя строка -->
  <div class="footer-copy">
    <p>&copy; {{ now.year }} Wiru Combat Academy — {{ _('Все права защищены') }}</p>
  </div>
</footer>


<script src="{{ url_for('static', filename='js/title-line.js') }}"></script>
</body>
</html>
